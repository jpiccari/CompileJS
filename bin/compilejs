#!/usr/bin/env node

'use strict';

var fs = require('fs'),
	Lexer = require('../lib/lexer');


function printToken(token) {
	var output = [];
	if(token.type) {
		output.push(token.type);
		if(token.value) {
			output.push(token.value);
		}
	}
	else {
		output.push('"' + token + '"');
	}
	console.log('Token ( ' + output.join(', ') + ' )');
}

function processSource(text) {
	var l = new Lexer(text),
		token;
	while((token = l.nextToken())) {
		printToken(token);
		if(token.toString() === 'eof') {
			break;
		}
	}
}


process.argv.splice(2).forEach(function(file) {
	fs.exists(file, function(exists) {
		if(exists) {
			fs.readFile(file, function(error, content) {
				processSource(content.toString());
			});
		}
	});
});
